"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[842],{28:(e,t,n)=>{n(1249),n(6977);var a=n(5243),o=n.n(a),i=o().map("map",{preferCanvas:!0});function r(){var e=appBaseUrl+"map/"+i.getBounds().getNorthEast().lat.toFixed(5)+"_"+i.getBounds().getNorthEast().lng.toFixed(5)+"_"+i.getBounds().getSouthWest().lat.toFixed(5)+"_"+i.getBounds().getSouthWest().lng.toFixed(5)+".json",t=new XMLHttpRequest;t.addEventListener("load",(function(){var e=JSON.parse(this.responseText),t={fillOpacity:1,stroke:!1,weight:0,color:"#ff0000",radius:4};o().geoJSON(e,{style:function(e){if(e.properties&&e.properties.type&&"trackpoint"===e.properties.type)return{color:"#0000ff",radius:1,fillOpacity:.4}},pointToLayer:function(e,n){return o().circleMarker(n,t)},onEachFeature:function(e,t){e.properties&&e.properties.popupContent&&t.bindPopup(e.properties.popupContent)}}).addTo(i)})),t.open("GET",e),t.send()}i.on("moveend",r),i.on("zoomend",r);var d=null,l=[0,0],s=document.getElementById("map").dataset;s&&s.latitude&&s.longitude&&v(l=new(o().LatLng)(s.latitude,s.longitude)),i.setView(l,12);var p=new XMLHttpRequest;p.addEventListener("load",(function(){var e=JSON.parse(this.responseText),t=o().control.layers().addTo(i);void 0!==e.edit_config&&t.addBaseLayer(o().tileLayer(e.edit_url,e.edit_config),void 0===e.edit_config.label?"edit":e.edit_config.label),t.addBaseLayer(o().tileLayer(e.view_url,e.view_config).addTo(i),void 0===e.view_config.label?"view":e.view_config.label)})),p.open("GET",appBaseUrl+"map-config.json"),p.send(),i.on("click",(function(e){s.edit&&(d||v(e.latlng),L(e.latlng))}));var u=document.querySelector('input[name="date"]'),c=null;function g(e){var t=appBaseUrl+"map/estimates.json?date="+e,n=new XMLHttpRequest;n.addEventListener("load",(function(){var e=JSON.parse(this.responseText),t=[e.lat,e.lng];null===c?(c=new(o().Marker)(t,{icon:f("send",[23,23],[23,0])}),i.addLayer(c)):c.setLatLng(t),i.setView(t,12)})),n.open("GET",t),n.send()}function f(e,t,n){return o().icon({iconUrl:"/build/images/"+e+".png",iconRetinaUrl:"/build/images/"+e+"-2x.png",iconSize:t,iconAnchor:n})}function v(e){d=new(o().Marker)(e,{draggable:s.edit,icon:f("map-pin",[20,24],[10,24])}),i.addLayer(d),d.on("dragend",(function(e){L(e.target.getLatLng())}))}function L(e){d.setLatLng(e),i.panTo(e),document.getElementById("latitude").value=e.lat.toFixed(5),document.getElementById("longitude").value=e.lng.toFixed(5)}u.addEventListener("change",(function(e){g(e.target.value)})),g(u.value)}},e=>{e.O(0,[98,805],(()=>{return t=28,e(e.s=t);var t}));e.O()}]);